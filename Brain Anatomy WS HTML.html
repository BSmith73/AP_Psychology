<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive AP Psychology: Brain Regions & Functions Worksheet</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better readability and aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            color: #334155; /* Darker text color */
        }
        .container {
            max-width: 1024px; /* Slightly wider for interactive elements */
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 1rem; /* Rounded corners for the main container */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        h1, h2 {
            color: #1e293b; /* Darker headings */
            font-weight: 700;
        }
        table {
            width: 100%;
            border-collapse: separate; /* Use separate for rounded corners on cells */
            border-spacing: 0;
            margin-top: 1.5rem;
            border-radius: 0.75rem; /* Rounded corners for the table */
            overflow: hidden; /* Ensures internal elements respect border-radius */
        }
        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0; /* Light border for rows */
        }
        th {
            background-color: #e0f2fe; /* Light blue header background */
            font-weight: 600;
            color: #1e40af; /* Darker blue text for headers */
            text-transform: uppercase;
            font-size: 0.875rem;
        }
        tr:last-child td {
            border-bottom: none; /* No border for the last row */
        }
        td {
            background-color: #f8fafc; /* Very light background for cells */
        }
        .word-bank-section {
            background-color: #eff6ff; /* Lighter blue for word bank */
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1.5rem;
            border: 1px dashed #93c5fd; /* Dashed border */
        }
        .word-bank-section h3 {
            color: #1d4ed8; /* Blue heading */
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        .word-bank-list {
            list-style: none; /* Remove default list style */
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); /* Responsive grid for word bank */
            gap: 0.5rem;
        }
        .word-bank-item {
            background-color: #dbeafe; /* Even lighter blue for list items */
            padding: 0.4rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            color: #1e40af;
            border: 1px solid #bfdbfe;
            cursor: grab; /* Indicate draggable */
            user-select: none; /* Prevent text selection during drag */
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        .word-bank-item:hover {
            background-color: #c3dafc;
        }
        .word-bank-item:active {
            cursor: grabbing;
            transform: scale(0.98);
        }
        .drop-target {
            min-height: 2.5rem; /* Ensure drop target has height */
            border: 1px dashed #cbd5e1; /* Dashed border for empty cells */
            background-color: #f0f4f8; /* Light background for drop areas */
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.9rem;
            color: #475569;
            cursor: pointer; /* Indicate clickable */
        }
        .drop-target.hovered {
            background-color: #e2e8f0; /* Highlight on hover */
            border-color: #64748b;
        }
        .drop-target.filled {
            border: 1px solid #94a3b8; /* Solid border when filled */
            background-color: #ffffff;
            color: #334155;
        }
        .drop-target.correct {
            background-color: #dcfce7; /* Green for correct */
            border-color: #22c55e;
        }
        .drop-target.incorrect {
            background-color: #fee2e2; /* Red for incorrect */
            border-color: #ef4444;
        }
        .check-button {
            background-color: #2563eb; /* Blue button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
            margin-top: 1.5rem;
            display: block;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .check-button:hover {
            background-color: #1d4ed8;
        }
        .reset-button {
            background-color: #64748b; /* Gray button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
            margin-top: 1rem;
            display: block;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .reset-button:hover {
            background-color: #475569;
        }
        .message-box {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 600;
            display: none; /* Hidden by default */
        }
        .message-box.show {
            display: block;
        }
        .message-box.success {
            background-color: #dcfce7;
            color: #16a34a;
            border: 1px solid #22c55e;
        }
        .message-box.error {
            background-color: #fee2e2;
            color: #dc2626;
            border: 1px solid #ef4444;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }
        .modal-close-button:hover {
            color: #334155;
        }
        .modal-options-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        .modal-option-item {
            background-color: #e0f2fe;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #93c5fd;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            font-size: 0.95rem;
            color: #1e40af;
            text-align: center;
        }
        .modal-option-item:hover {
            background-color: #bfdbfe;
            transform: translateY(-2px);
        }
        .modal-option-item.selected {
            background-color: #93c5fd;
            color: white;
            border-color: #1d4ed8;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                margin: 1rem;
                padding: 1rem;
            }
            th, td {
                padding: 0.5rem 0.75rem;
                font-size: 0.85rem;
            }
            .word-bank-list {
                grid-template-columns: 1fr; /* Stack on small screens */
            }
            .modal-content {
                padding: 1rem;
            }
            .modal-options-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-3xl md:text-4xl text-center mb-6">Interactive AP Psychology: Brain Regions & Functions Worksheet</h1>
        <p class="text-lg mb-4">
            <strong>Directions:</strong> Drag and drop the terms from the word bank into the correct "Primary Function" and "Effect of Damage" cells in the chart below. Alternatively, **click on an empty dashed box** in the chart to choose from a pop-up list of options. Click "Check Answers" when you're done!
        </p>

        <div class="word-bank-section">
            <h3 class="text-xl mb-3">Word Bank</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <h4 class="font-semibold text-lg mb-2 text-blue-800">Primary Functions:</h4>
                    <ul id="functions-bank" class="word-bank-list">
                        <!-- These will be dynamically added via JS for drag-and-drop -->
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-lg mb-2 text-blue-800">Effects of Damage:</h4>
                    <ul id="damage-bank" class="word-bank-list">
                        <!-- These will be dynamically added via JS for drag-and-drop -->
                    </ul>
                </div>
            </div>
        </div>

        <h2 class="text-2xl md:text-3xl text-center my-6">Brain Regions & Functions Chart</h2>
        <div class="overflow-x-auto rounded-xl shadow-lg">
            <table class="min-w-full" id="worksheet-table">
                <thead>
                    <tr>
                        <th class="rounded-tl-lg">Brain Region</th>
                        <th>Primary Function</th>
                        <th class="rounded-tr-lg">Effect of Damage</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Rows will be dynamically generated and populated by JS -->
                </tbody>
            </table>
        </div>

        <button id="check-answers-button" class="check-button">Check Answers</button>
        <button id="reset-button" class="reset-button">Reset Worksheet</button>
        <div id="message-box" class="message-box"></div>
    </div>

    <!-- Modal Structure -->
    <div id="selection-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-button" class="modal-close-button">&times;</button>
            <h3 class="text-xl font-semibold text-center text-gray-800 mb-4">Select an Option</h3>
            <ul id="modal-options-list" class="modal-options-list">
                <!-- Options will be dynamically loaded here -->
            </ul>
        </div>
    </div>

    <script>
        // Data for the worksheet, including correct answers
        const worksheetData = [
            {
                region: "Medulla",
                function: "Controls basic life-sustaining functions like breathing and heart rate.",
                damage: "Damaged: Someone's heart rate and breathing become dangerously irregular."
            },
            {
                region: "Reticular Formation",
                function: "Regulates arousal, attention, and sleep-wake cycles.",
                damage: "Damaged: A person is awake but their consciousness is impaired, and they may fall into a coma."
            },
            {
                region: "Cerebellum",
                function: "Coordinates voluntary movement, balance, and procedural memory.",
                damage: "Damaged: An individual has no sense of balance and clumsy, uncoordinated movements."
            },
            {
                region: "Thalamus",
                function: "Relays all sensory information (except smell) to the cerebral cortex.",
                damage: "Damaged: Difficulty relaying sensory information, leading to sensory confusion."
            },
            {
                region: "Hypothalamus",
                function: "Regulates homeostatic functions like body temperature, hunger, and thirst.",
                damage: "Damaged: A person feels constantly hungry and struggles with weight gain."
            },
            {
                region: "Amygdala",
                function: "Processes emotions, especially fear and aggression.",
                damage: "Damaged: A person is unable to control their emotional responses, leading to outbursts of rage."
            },
            {
                region: "Hippocampus",
                function: "Consolidates new memories into long-term memory.",
                damage: "Damaged: Cannot form new memories after a concussion."
            },
            {
                region: "Corpus Callosum",
                function: "Connects the two cerebral hemispheres, allowing for communication.",
                damage: "Damaged: Unable to verbally name an object seen in the left visual field."
            },
            {
                region: "Frontal Lobe",
                function: "Initiates voluntary movements and is involved in personality, judgment, and emotional regulation.",
                damage: "Damaged: Significant changes in personality, impulsivity, or difficulty initiating complex voluntary movements."
            },
            {
                region: "Parietal Lobe",
                function: "Processes sensory information from various senses, spatial awareness, and navigation.",
                damage: "Damaged: Difficulty with spatial awareness, navigation, or recognizing objects by touch."
            },
            {
                region: "Occipital Lobe",
                function: "Processes visual information.",
                damage: "Damaged: A person's vision is completely gone."
            },
            {
                region: "Temporal Lobe",
                function: "Processes auditory information.",
                damage: "Damaged: A person can no longer hear sounds."
            },
            {
                region: "Broca’s Area",
                function: "Directs speech production.",
                damage: "Damaged: A person can understand what is said to them but is unable to form words to reply."
            },
            {
                region: "Wernicke’s Area",
                function: "Processes language comprehension.",
                damage: "Damaged: An individual has difficulty understanding spoken language."
            },
            {
                region: "Prefrontal Cortex",
                function: "Involved in higher-order thinking, planning, and executive functions.",
                damage: "Damaged: An individual struggles to make rational decisions or plan for the future."
            },
            {
                region: "Motor Cortex",
                function: "Controls voluntary muscle movements.",
                damage: "Damaged: The left side of a person's body is paralyzed."
            },
            {
                region: "Somatosensory Cortex",
                function: "Processes touch, temperature, and pain sensations.",
                damage: "Damaged: A person experiences a complete lack of touch sensation."
            },
            {
                region: "Left Hemisphere",
                function: "Specializes in language processing, logical reasoning, and analytical thought.",
                damage: "Damaged: Difficulty with speech, reading, or mathematical calculations."
            },
            {
                region: "Right Hemisphere",
                function: "Specializes in spatial reasoning, facial recognition, and processing non-verbal cues and emotions.",
                damage: "Damaged: Difficulty recognizing faces or navigating familiar spaces, or unable to move left side of the body."
            }
        ];

        let draggedItem = null;
        let activeDropTarget = null; // To keep track of which drop target was clicked
        const functionsBankEl = document.getElementById('functions-bank');
        const damageBankEl = document.getElementById('damage-bank');
        const worksheetTableBody = document.querySelector('#worksheet-table tbody');
        const checkAnswersBtn = document.getElementById('check-answers-button');
        const resetButton = document.getElementById('reset-button');
        const messageBox = document.getElementById('message-box');

        // Modal elements
        const modalOverlay = document.getElementById('selection-modal-overlay');
        const modalCloseButton = document.getElementById('modal-close-button');
        const modalOptionsList = document.getElementById('modal-options-list');

        // Function to shuffle an array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        // Initialize the worksheet and word banks
        function initializeWorksheet() {
            // Clear previous content
            functionsBankEl.innerHTML = '';
            damageBankEl.innerHTML = '';
            worksheetTableBody.innerHTML = '';
            messageBox.classList.remove('show', 'success', 'error');
            messageBox.textContent = '';
            hideModal(); // Ensure modal is hidden on reset

            // Populate Functions word bank
            const shuffledFunctions = shuffleArray(worksheetData.map(d => d.function));
            shuffledFunctions.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                li.classList.add('word-bank-item');
                li.setAttribute('draggable', 'true');
                li.dataset.type = 'function'; // Custom data attribute to identify type
                functionsBankEl.appendChild(li);
            });

            // Populate Damaged Scenarios word bank
            const shuffledDamage = shuffleArray(worksheetData.map(d => d.damage));
            shuffledDamage.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                li.classList.add('word-bank-item');
                li.setAttribute('draggable', 'true');
                li.dataset.type = 'damage'; // Custom data attribute to identify type
                damageBankEl.appendChild(li);
            });

            // Create table rows and drop targets
            worksheetData.forEach((data, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${data.region}</td>
                    <td><div class="drop-target" data-row-index="${index}" data-column-type="function"></div></td>
                    <td><div class="drop-target" data-row-index="${index}" data-column-type="damage"></div></td>
                `;
                worksheetTableBody.appendChild(tr);
            });

            addEventListeners();
        }

        // Add event listeners for drag and drop and click-to-select
        function addEventListeners() {
            // Drag and Drop Listeners for word bank items
            document.querySelectorAll('.word-bank-item').forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    draggedItem = e.target;
                    e.dataTransfer.setData('text/plain', e.target.textContent);
                    e.dataTransfer.effectAllowed = 'move';
                    setTimeout(() => {
                        e.target.classList.add('opacity-50'); // Hide dragged item visually
                    }, 0);
                });

                item.addEventListener('dragend', (e) => {
                    e.target.classList.remove('opacity-50');
                    draggedItem = null;
                });
            });

            // Drag and Drop / Click Listeners for drop targets
            document.querySelectorAll('.drop-target').forEach(target => {
                // Dragover event for visual feedback during drag
                target.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Allow drop
                    e.dataTransfer.dropEffect = 'move';
                    // Only allow dropping 'function' items into 'function' columns and 'damage' into 'damage' columns
                    if (draggedItem && draggedItem.dataset.type === target.dataset.columnType) {
                         target.classList.add('hovered');
                    } else {
                        e.dataTransfer.dropEffect = 'none'; // Disallow drop if types don't match
                    }
                });

                // Dragleave event to remove hover feedback
                target.addEventListener('dragleave', (e) => {
                    target.classList.remove('hovered');
                });

                // Drop event to place the dragged item
                target.addEventListener('drop', (e) => {
                    e.preventDefault();
                    target.classList.remove('hovered');

                    if (draggedItem && draggedItem.dataset.type === target.dataset.columnType) {
                        placeItemInTarget(target, draggedItem);
                    }
                });

                // Click event for pop-up selection
                target.addEventListener('click', (e) => {
                    activeDropTarget = e.currentTarget; // Store reference to the clicked target
                    showModal(activeDropTarget.dataset.columnType);
                });
            });

            // Check Answers and Reset Buttons
            checkAnswersBtn.addEventListener('click', checkAnswers);
            resetButton.addEventListener('click', initializeWorksheet);

            // Modal Event Listeners
            modalCloseButton.addEventListener('click', hideModal);
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) { // Close only if clicking the overlay itself
                    hideModal();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modalOverlay.classList.contains('show')) {
                    hideModal();
                }
            });
        }

        // Function to place an item into a drop target (used by both drag/drop and click-to-select)
        function placeItemInTarget(target, itemToPlace) {
            // If the target already has content, move it back to its original word bank
            if (target.hasChildNodes()) {
                const existingItem = target.querySelector('.word-bank-item');
                if (existingItem) {
                    if (existingItem.dataset.type === 'function') {
                        functionsBankEl.appendChild(existingItem);
                    } else if (existingItem.dataset.type === 'damage') {
                        damageBankEl.appendChild(existingItem);
                    }
                    existingItem.classList.remove('opacity-0', 'pointer-events-none'); // Make it visible and interactive again
                    existingItem.style.display = 'block'; // Ensure it's displayed
                }
            }

            // Append the new item to the drop target
            target.innerHTML = ''; // Clear any placeholder text
            target.appendChild(itemToPlace);
            itemToPlace.classList.remove('opacity-50'); // Make it visible in the new spot
            itemToPlace.style.display = 'block'; // Ensure it's displayed
            target.classList.add('filled');
            target.classList.remove('correct', 'incorrect'); // Clear feedback if re-filling
        }

        // Show the modal with relevant options
        function showModal(columnType) {
            modalOptionsList.innerHTML = ''; // Clear previous options
            let sourceBank = (columnType === 'function') ? functionsBankEl : damageBankEl;

            // Populate modal with available items from the source bank
            Array.from(sourceBank.children).forEach(item => {
                const li = document.createElement('li');
                li.textContent = item.textContent;
                li.classList.add('modal-option-item');
                li.dataset.originalText = item.textContent; // Store original text to find the actual item later
                li.dataset.type = item.dataset.type; // Store type for consistency

                li.addEventListener('click', () => {
                    // Find the original item in the word bank
                    const originalItem = Array.from(sourceBank.children).find(
                        bankItem => bankItem.textContent === li.dataset.originalText
                    );
                    if (originalItem && activeDropTarget) {
                        placeItemInTarget(activeDropTarget, originalItem);
                    }
                    hideModal();
                });
                modalOptionsList.appendChild(li);
            });

            modalOverlay.classList.add('show');
        }

        // Hide the modal
        function hideModal() {
            modalOverlay.classList.remove('show');
            activeDropTarget = null; // Clear active target
        }

        // Check the answers
        function checkAnswers() {
            let allCorrect = true;
            let filledCount = 0;
            let totalCells = worksheetData.length * 2; // Each region has a function and a damage cell

            document.querySelectorAll('.drop-target').forEach(target => {
                target.classList.remove('correct', 'incorrect'); // Clear previous feedback
                const rowIndex = parseInt(target.dataset.rowIndex);
                const columnType = target.dataset.columnType;
                const expectedValue = worksheetData[rowIndex][columnType];
                const droppedItem = target.querySelector('.word-bank-item');

                if (droppedItem) {
                    filledCount++;
                    const studentAnswer = droppedItem.textContent.trim();

                    if (studentAnswer === expectedValue.trim()) {
                        target.classList.add('correct');
                    } else {
                        target.classList.add('incorrect');
                        allCorrect = false;
                    }
                } else {
                    allCorrect = false; // Unfilled cells mean not all correct
                }
            });

            if (filledCount < totalCells) {
                showMessage(`Please fill in all ${totalCells} cells before checking. You have filled ${filledCount}.`, 'error');
                allCorrect = false; // Not all cells filled, so not all correct
            } else if (allCorrect) {
                showMessage('Excellent! All your answers are correct!', 'success');
            } else {
                showMessage('Some answers are incorrect. Review the highlighted cells and try again!', 'error');
            }
        }

        // Show messages to the user
        function showMessage(msg, type) {
            messageBox.textContent = msg;
            messageBox.classList.remove('success', 'error');
            messageBox.classList.add('show', type);
        }

        // Initialize the worksheet when the window loads
        window.onload = initializeWorksheet;
    </script>
</body>
</html>
